<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link
rel="stylesheet" type="text/css"
id="ss"
href="../../../assets/css/common.css"
/>
<title>TLA+ Proof System</title>
</head>
<body>


<div id="wrapper">
  <div id="header">
    <div id="title">
      <a class="title"
        href="../../Home.html">
            TLA+ Proof System
      </a>
    </div>
    <div class="logomsr">
      <a href="https://www.msr-inria.inria.fr">
        <img
            src="../../../assets/images/logo-MS-Research-Inria-Joint-Centre-Small.png"
            alt="Microsoft Research - Inria Joint Centre"
            class="logo"
        />
      </a>
    </div>
  </div>
  <ul id="nav">


            <li>
                <a class="off"
                    href="../../Home.html">
                    Home
                </a>
            </li>
            

            <li>
                <a class="off"
                    href="../../Download.html">
                    Download
                </a>
            </li>
            

            <li>
                <a class="off"
                    href="../../Documentation.html">
                    Documentation
                </a>
            </li>
            

            <li>
                <a class="off"
                    href="../../Community.html">
                    Community
                </a>
            </li>
            

</ul>
<div id="transp"></div>
<div id="content" class="clearfix">
  <div id="col_1">

      <h2>Menu</h2>
      <ul id="menu">

            <li class="menuoff">
                <a
                    href="../../documentation/Tutorial.html">
                    Tutorial
                </a>
            </li>
            

                <li class="indexoff">
                    <a
                        href="../../documentation/tutorial/The_example.html">
                        The example
                    </a>
                </li>
                

                <li class="indexoff">
                    <a
                        href="../../documentation/tutorial/A_simple_proof.html">
                        A simple proof
                    </a>
                </li>
                

                <li class="indexoff">
                    <a
                        href="../../documentation/tutorial/Hierarchical_proofs.html">
                        Hierarchical proofs
                    </a>
                </li>
                

                <li class="indexoff">
                    <a
                        href="../../documentation/tutorial/Advanced_options.html">
                        Advanced options
                    </a>
                </li>
                

                <li class="indexoff">
                    <a
                        href="../../documentation/tutorial/Other_proof_constructs.html">
                        Other proof constructs
                    </a>
                </li>
                

                <li class="indexoff">
                    <a
                        href="../../documentation/tutorial/Tactics.html">
                        Tactics
                    </a>
                </li>
                

                <li class="indexoff">
                    <a
                        href="../../documentation/tutorial/Practical_hints.html">
                        Practical hints
                    </a>
                </li>
                

            <li class="menuoff">
                <a
                    href="../../documentation/Unsupported_features.html">
                    Unsupported features
                </a>
            </li>
            

            <li class="menuoff">
                <a
                    href="../../documentation/Publications.html">
                    Publications
                </a>
            </li>
            

            <li class="menuoff">
                <a
                    href="../../documentation/TLA+_Hyperbook.html">
                    TLA+ Hyperbook
                </a>
            </li>
            

            <li class="menuoff">
                <a
                    href="../../documentation/TLA+_Video_Course.html">
                    TLA+ Video Course
                </a>
            </li>
            

            <li class="menuoff">
                <a
                    href="../../documentation/Misc.html">
                    Misc
                </a>
            </li>
            

</ul>
</div>
<div id="col_2">

<h2 id="preamble">Preamble</h2>
<div class="hr"></div>

<p>TLAPS is a proof system for checking TLA+ proofs. See the <a href="https://research.microsoft.com/en-us/um/people/lamport/tla/tla.html">TLA Home page</a> to learn about the TLA+ specification language. The proof language is a new addition to TLA+; it is described <a href="https://research.microsoft.com/en-us/um/people/lamport/tla/tla2.html">here</a>. However, this is a reference manual; you should try some examples before reading it.</p>
<p>This tutorial consists of a simple example. If you have no experience with TLA+ or using theorem provers, you might start instead with the <a href="https://research.microsoft.com/en-us/um/people/lamport/tla/hyperbook.html">TLA+ Hyperbook</a> or the <a href="https://lamport.azurewebsites.net/video/videos.html">TLA+ Video Course</a>. This tutorial will introduce concepts of the <a href="https://research.microsoft.com/en-us/um/people/lamport/tla/tla2.html">TLA+ proof language</a> as needed.</p>
<p>The proof system is designed to be used with the <a href="https://research.microsoft.com/en-us/um/people/lamport/tla/toolbox.html">ToolBox</a> IDE. In this tutorial, we assume that you are using that IDE (even if we sometimes indicate how proofs can be run from the command line).</p>
<h2 id="the-example">The example</h2>
<div class="hr"></div>

<p>Broadly speaking, a TLA+ proof is a collection of <em>claims</em>, arranged in a hierarchical structure which we describe below, where each claim has an <em>assertion</em> that is either <em>unjustified</em> or justified by a collection of <em>cited facts</em>. The purpose of TLAPS is to check the user-provided proofs of theorems, that is, to check that the hierarchy of claims indeed establishes the truth of the theorem if the claims were true, and then to check that the assertion of every justified claim indeed is implied <em>by</em> its cited facts. If a TLA+ theorem has a proof with no unjustified claims, then, as a result of checking the proof, TLAPS verifies the truth of the theorem.</p>
<p>We shall illustrate the TLAPS by proving the correctness of the <a href="https://en.wikipedia.org/wiki/Euclidean_algorithm">Euclidean algorithm</a>.</p>
<h3 id="the-algorithm">The algorithm</h3>
<div class="hr"></div>

<p>The well-known Euclidean algorithm can be written in the <a href="https://lamport.azurewebsites.net/tla/p-manual.pdf">PlusCal</a> language as follows:</p>
<pre class="tla"><code>--algorithm Euclid {
  variables x \in 1..M, y \in 1..N, x0 = x, y0 = y;
  {
    while (x # y) {
      if (x &amp;lt; y) { y := y - x; }
      else { x := x-y; }
    };
    assert x = GCD(x0, y0) /\ y = GCD(x0, y0)
  }
}
</code></pre>
<p>The PlusCal translator translates this algorithm into a TLA+ specification that we could prove correct. However, in this tutorial, we shall write a somewhat simpler specification of Euclid's algorithm directly in TLA+.</p>
<h3 id="creating-a-new-tla-module">Creating a new TLA+ module</h3>
<div class="hr"></div>

<p>First of all, let us create a new specification within the ToolBox (click on the thumbnails to expand the screenshots).</p>
<div class="bg">

<table>
<tbody>
<tr class="odd">
<td><a href="screenshots/addnewspec.png"><img src="screenshots/addnewspecs.png" alt="screenshot" /></a></td>
<td><a href="screenshots/name.png"><img src="screenshots/names.png" alt="screenshot" /></a></td>
<td><a href="screenshots/result.png"><img src="screenshots/results.png" alt="screenshot" /></a></td>
</tr>
</tbody>
</table>
</div>

<h3 id="importing-modules">Importing modules</h3>
<div class="hr"></div>

<p>In order to get the definitions of arithmetic operators (+, -, <em>etc.</em>), we shall make this specification <em>extend</em> the Integers standard module.</p>
<pre class="tla"><code>-------------------- <span class="purple">MODULE</span> Euclid --------------------
<span class="purple">EXTENDS</span> Integers

=======================================================
</code></pre>
<h3 id="definitions">Definitions</h3>
<div class="hr"></div>

<p>We shall then define the GCD of two integers. For that purpose, let us define the predicate "p divides q" as follows: p divides q iff there exists some integer d in the interval 1..q such that q is equal to p times d.</p>
<pre class="tla"><code>p | q == \E d \in 1..q : q = p * d
</code></pre>
<p>We then define the set of divisors of an integer q as the sets of integers which both belong to the interval 1..q and divide q:</p>
<pre class="tla"><code>Divisors(q) == {d \in 1..q : d | q}
</code></pre>
<p>We define the maximum of a set S as one of the elements of this set which is greater than or equal to all the other elements:</p>
<pre class="tla"><code>Maximum(S) == <span class="purple">CHOOSE</span> x \in S : \A y \in S : x &gt;= y
</code></pre>
<p>And finally, we define the GCD of two integers p and q to be the maximum of the intersection of Divisors(p) and Divisors(q):</p>
<pre class="tla"><code>GCD(p,q) == Maximum(Divisors(p) \cap Divisors(q))
</code></pre>
<p>For convenience, we shall also define the set of all positive integers as:</p>
<pre class="tla"><code>Number == Nat \ {0}
</code></pre>
<p>When we save the specification (with the menu File &gt; Save), the toolbox launches the SANY syntactic analyzer and reports any errors that might appear.</p>
<h3 id="constants-and-variables">Constants and variables</h3>
<div class="hr"></div>

<p>We then define the two constants and two variables needed to describe the Euclidean algorithm, where M and N are the values whose GCD is to be computed:</p>
<pre class="tla"><code><span class="purple"><span class="purple">CONSTANT</span>S</span> M, N
<span class="purple"><span class="purple">VARIABLE</span>S</span> x, y
</code></pre>
<h3 id="the-specification">The specification</h3>
<div class="hr"></div>

<p>We define the initial state of the Euclidean algorithm as follows:</p>
<pre class="tla"><code>Init == (x = M) /\ (y = N)
</code></pre>
<p>In the Euclidean algorithm, two actions can be performed:</p>
<ul>
<li>set the value of <code>y</code> to <code>y - x</code> if <code>x &lt; y</code></li>
<li>set the value of <code>x</code> to <code>x - y</code> if <code>x &gt; y</code>.</li>
</ul>
<p>These actions are again written as a definition called Next, which specifies the next-state relation. In TLA+, a primed variable refers to its value at the next state of the algorithm.</p>
<pre class="tla"><code>Next == \/ /\ x &lt; y
           /\ y&#39; = y - x
           /\ x&#39; = x
        \/ /\ y &lt; x
           /\ x&#39; = x-y
           /\ y&#39; = y
</code></pre>
<p>The specification of the algorithm asserts that the variables have the correct initial values and, in each execution step, either a Next action is performed or x and y keep the same values:</p>
<pre class="tla"><code>Spec == Init /\ [][Next]_&lt;&lt;x,y&gt;&gt;
</code></pre>
<p>(For reasons that are irrelevant to this algorithm, TLA specifications always allow <em>stuttering steps</em> that leave all the variables unchanged.)</p>
<p>We want to prove that the algorithm always satisfies the following property:</p>
<pre class="tla"><code>ResultCorrect == (x = y) =&gt; x = GCD(M, N)
</code></pre>
<p>Hence we want to prove the following theorem named Correctness:</p>
<pre class="tla"><code><span class="purple">THEOREM</span> Correctness == Spec =&gt; []ResultCorrect
</code></pre>
<h3 id="summary">Summary</h3>
<div class="hr"></div>

<pre class="tla"><code>-------------------- <span class="purple">MODULE</span> Euclid --------------------
<span class="purple">EXTENDS</span> Integers

p | q == \E d \in 1..q : q = p * d
Divisors(q) == {d \in 1..q : d | q}
Maximum(S) == <span class="purple">CHOOSE</span> x \in S : \A y \in S : x &gt;= y
GCD(p,q) == Maximum(Divisors(p) \cap Divisors(q))
Number == Nat \ {0}

<span class="purple"><span class="purple">CONSTANT</span>S</span> M, N
<span class="purple"><span class="purple">VARIABLE</span>S</span> x, y

Init == (x = M) /\ (y = N)

Next == \/ /\ x &lt; y
           /\ y&#39; = y - x
           /\ x&#39; = x
        \/ /\ y &lt; x
           /\ x&#39; = x-y
           /\ y&#39; = y

Spec == Init /\ [][Next]_&lt;&lt;x,y&gt;&gt;

ResultCorrect == (x = y) =&gt; x = GCD(M, N)

<span class="purple">THEOREM</span> Correctness == Spec =&gt; []ResultCorrect

=======================================================
</code></pre>


    </div>
  </div>
</div>

</script>
</body>
</html>
